# QuMail Secure Email Backend Environment Configuration
# Copy this file to .env and fill in your actual values

# Application Configuration
APP_NAME=QuMail Secure Email Backend
APP_VERSION=1.0.0-secure
APP_ENV=development
APP_HOST=0.0.0.0
APP_PORT=8000
DEBUG=true

# Security Configuration
SECRET_KEY=YOUR_SECRET_KEY
ACCESS_TOKEN_EXPIRE_MINUTES=60
ENCRYPTION_MASTER_KEY=YOUR_ENCRYPTION_KEY

# Database Configuration
# MongoDB Atlas (Cloud Database)
DATABASE_URL=mongodb+srv://user:password@cluster.mongodb.net/qumail?retryWrites=true&w=majority
FALLBACK_DATABASE_URL=mongodb://127.0.0.1:27017/qumail?directConnection=true
MONGO_FORCE_LOCAL=false
MONGO_TLS_ALLOW_INVALID_CERTS=true
MONGO_TLS_CA_FILE=
MONGO_EMBEDDED_ENABLED=true
MONGO_EMBEDDED_DB_NAME=qumail_dev

# SQLite (recommended for local development without Docker)
# DATABASE_URL=sqlite+aiosqlite:///./qumail.db

# PostgreSQL (if you have local PostgreSQL installed)
# DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/qumail

# Google OAuth Configuration
GOOGLE_CLIENT_ID=YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=REDACTED_SECRET
GOOGLE_REDIRECT_URI=http://localhost:5173/auth/callback

# KM Server Configuration (using cloud KME servers on Render)
KM1_BASE_URL=https://qumail-kme1-pmsy.onrender.com
KM2_BASE_URL=https://qumail-kme2-pmsy.onrender.com

# Client certificates for SAE authentication with KM servers
KM1_CLIENT_CERT_PFX=../next-door-key-simulator/certs/sae-1.crt.pem
KM2_CLIENT_CERT_PFX=../next-door-key-simulator/certs/sae-2.crt.pem
KM1_CLIENT_KEY=../next-door-key-simulator/certs/sae-1.key.pem
KM2_CLIENT_KEY=../next-door-key-simulator/certs/sae-2.key.pem
KM_CLIENT_CERT_PASSWORD=

# SAE IDs from actual KME configuration
SENDER_SAE_ID=1
RECEIVER_SAE_ID=2

# CA certificates for server verification
KM1_CA_CERT=../next-door-key-simulator/certs/ca.crt.pem
KM2_CA_CERT=../next-door-key-simulator/certs/ca.crt.pem

# Security Settings
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:5174,http://127.0.0.1:3000,https://qumail-rho.vercel.app
CORS_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Logging Configuration
LOG_LEVEL=INFO
LOG_FILE=qumail-backend.log

# Development Settings (disable in production)
RELOAD_ON_CHANGE=true
SHOW_DOCS=true

# Production Security Settings (enable in production)
# HTTPS_ONLY=true
# SECURE_COOKIES=true
# CSRF_PROTECTION=true
# ENFORCE_HTTPS=true
# HSTS_MAX_AGE=31536000

# Optional: Redis for session storage (recommended for production)
# REDIS_URL=redis://localhost:6379/0

# Optional: Sentry for error tracking
# SENTRY_DSN=your-sentry-dsn-here

# Health Check Configuration
HEALTH_CHECK_TIMEOUT=10
KM_CONNECTION_TIMEOUT=5

# Performance Configuration
WORKERS=1
MAX_CONNECTIONS=100
KEEPALIVE_TIMEOUT=5
