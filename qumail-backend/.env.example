# QuMail Secure Email Backend Environment Configuration
# Copy this file to .env and fill in your actual values

# Application Configuration
APP_NAME=QuMail Secure Email Backend
APP_VERSION=1.0.0-secure
APP_ENV=development
APP_HOST=0.0.0.0
APP_PORT=8000
DEBUG=true

# Security Configuration
SECRET_KEY=your-super-secret-key-here-change-this-in-production-min-32-chars
ACCESS_TOKEN_EXPIRE_MINUTES=60
ENCRYPTION_MASTER_KEY=your-fernet-encryption-key-here-base64-encoded-32-bytes

# Database Configuration
# MongoDB Atlas URI (recommended for production / cloud testing)
DATABASE_URL=mongodb+srv://username:password@cluster0.mongodb.net/qumail?retryWrites=true&w=majority

# Optional local MongoDB fallback (started via Docker or native mongod)
FALLBACK_DATABASE_URL=mongodb://127.0.0.1:27017/qumail?directConnection=true
MONGO_FORCE_LOCAL=false
MONGO_TLS_ALLOW_INVALID_CERTS=true
MONGO_TLS_CA_FILE=
MONGO_EMBEDDED_ENABLED=true
MONGO_EMBEDDED_DB_NAME=qumail_dev

# Legacy SQLite option (only if you still use the old stack)
# DATABASE_URL=sqlite+aiosqlite:///./qumail.db

# Google OAuth Configuration
GOOGLE_CLIENT_ID=YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=REDACTED_SECRET
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/callback

# Yahoo OAuth Configuration (get from https://developer.yahoo.com/apps/)
# Note: Yahoo requires HTTPS redirect URIs, use 127.0.0.1 instead of localhost
YAHOO_CLIENT_ID=your_yahoo_client_id
YAHOO_CLIENT_SECRET=your_yahoo_client_secret
YAHOO_REDIRECT_URI=https://127.0.0.1:5173/auth/yahoo/callback

# KM Server Configuration (matching actual qkd_kme_server-master)
KM1_BASE_URL=https://localhost:13000
KM2_BASE_URL=https://localhost:14000

# Client certificates for SAE authentication with KM servers
KM1_CLIENT_CERT_PFX=../qkd_kme_server-master/certs/kme-1-local-zone/client_1.pfx
KM2_CLIENT_CERT_PFX=../qkd_kme_server-master/certs/kme-2-local-zone/client_3.pfx
KM_CLIENT_CERT_PASSWORD=

# SAE IDs from certificate analysis
SENDER_SAE_ID=1
RECEIVER_SAE_ID=3

# CA certificates for server verification
KM1_CA_CERT=../qkd_kme_server-master/certs/kme-1-local-zone/ca.crt
KM2_CA_CERT=../qkd_kme_server-master/certs/kme-2-local-zone/ca.crt

# Security Settings
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173,http://127.0.0.1:3000
CORS_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Logging Configuration
LOG_LEVEL=INFO
LOG_FILE=qumail-backend.log

# Development Settings (disable in production)
RELOAD_ON_CHANGE=true
SHOW_DOCS=true

# Production Security Settings (enable in production)
# HTTPS_ONLY=true
# SECURE_COOKIES=true
# CSRF_PROTECTION=true
# ENFORCE_HTTPS=true
# HSTS_MAX_AGE=31536000

# Optional: Redis for session storage (recommended for production)
# REDIS_URL=redis://localhost:6379/0

# Optional: Sentry for error tracking
# SENTRY_DSN=your-sentry-dsn-here

# Health Check Configuration
HEALTH_CHECK_TIMEOUT=10
KM_CONNECTION_TIMEOUT=5

# Performance Configuration
WORKERS=1
MAX_CONNECTIONS=100
KEEPALIVE_TIMEOUT=5
