import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState, useRef, useEffect } from 'react';
import { Button } from '../ui/Button';
export const Header = ({ user, onCompose, onSettings, searchQuery, onSearchChange, currentView = 'email', onViewChange }) => {
    const [showUserMenu, setShowUserMenu] = useState(false);
    const [showSearchSuggestions, setShowSearchSuggestions] = useState(false);
    const [isSearching, setIsSearching] = useState(false);
    const userMenuRef = useRef(null);
    const searchRef = useRef(null);
    // Close menus when clicking outside
    useEffect(() => {
        const handleClickOutside = (event) => {
            if (userMenuRef.current && !userMenuRef.current.contains(event.target)) {
                setShowUserMenu(false);
            }
            if (searchRef.current && !searchRef.current.contains(event.target)) {
                setShowSearchSuggestions(false);
            }
        };
        document.addEventListener('mousedown', handleClickOutside);
        return () => {
            document.removeEventListener('mousedown', handleClickOutside);
        };
    }, []);
    // Simulate search delay
    useEffect(() => {
        if (searchQuery) {
            setIsSearching(true);
            const timer = setTimeout(() => setIsSearching(false), 500);
            return () => clearTimeout(timer);
        }
    }, [searchQuery]);
    const handleLogout = () => {
        localStorage.removeItem('access_token');
        localStorage.removeItem('refresh_token');
        localStorage.removeItem('user');
        window.location.href = '/login';
    };
    return (_jsx("header", { className: "bg-white dark:bg-[#0d1117] border-b border-gray-200 dark:border-gray-800 px-4 py-2 z-50", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center gap-4", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center", children: _jsx("svg", { className: "w-5 h-5 text-white", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" }) }) }), _jsx("div", { children: _jsx("h1", { className: "text-lg font-semibold text-gray-900 dark:text-white", children: "QuMail" }) })] }), _jsx("div", { className: "hidden lg:flex items-center gap-2", children: _jsxs("div", { className: "flex items-center gap-1.5 text-xs text-gray-600 dark:text-gray-400", children: [_jsx("div", { className: "w-2 h-2 rounded-full bg-green-500" }), _jsx("span", { className: "font-medium", children: "QKD Active" })] }) })] }), _jsxs("div", { className: "flex-1 max-w-xl mx-6", ref: searchRef, children: [_jsxs("div", { className: "relative", children: [_jsx("div", { className: "absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none", children: isSearching ? (_jsx("div", { className: "w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin" })) : (_jsx("svg", { className: "w-4 h-4 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" }) })) }), _jsx("input", { type: "text", value: searchQuery, onChange: (e) => onSearchChange(e.target.value), onFocus: () => setShowSearchSuggestions(true), onBlur: () => {
                                        setTimeout(() => setShowSearchSuggestions(false), 200);
                                    }, placeholder: "Search emails...", className: "block w-full pl-10 pr-16 py-2.5 border border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors" }), _jsxs("div", { className: "absolute inset-y-0 right-0 flex items-center pr-2 gap-1.5", children: [searchQuery && (_jsx("button", { onClick: () => onSearchChange(''), className: "p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors", children: _jsx("svg", { className: "h-3.5 w-3.5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M6 18L18 6M6 6l12 12" }) }) })), _jsx("kbd", { className: "hidden sm:inline-flex items-center px-1.5 py-0.5 text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded", children: "\u2318K" })] })] }), showSearchSuggestions && searchQuery && (_jsx("div", { className: "absolute top-full left-0 right-0 mt-1.5 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50", children: _jsxs("div", { className: "p-2", children: [_jsx("div", { className: "text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5", children: "Search Results" }), _jsx("div", { className: "space-y-0.5", children: ['Recent email from ' + searchQuery, 'Encrypted messages containing "' + searchQuery + '"', 'Emails in folder: ' + searchQuery].map((search, index) => (_jsxs("button", { onClick: () => onSearchChange(search), className: "flex items-center gap-1.5 w-full p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left", children: [_jsx("svg", { className: "w-3.5 h-3.5 text-gray-400", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" }) }), _jsx("span", { className: "text-xs text-gray-700 dark:text-gray-300", children: search })] }, index))) })] }) }))] }), _jsxs("div", { className: "flex items-center gap-2", children: [currentView === 'quantum' && onViewChange && (_jsxs(Button, { onClick: () => onViewChange('email'), variant: "outline", className: "px-3 py-1.5 text-xs font-semibold text-gray-700 border-gray-300 bg-white hover:bg-gray-50 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 flex items-center space-x-1.5 transition-all duration-200 rounded-xl hover:scale-105", children: [_jsx("svg", { className: "w-3.5 h-3.5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" }) }), _jsx("span", { children: "Back to Email" })] })), currentView === 'email' && (_jsxs(Button, { onClick: onCompose, className: "inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors", children: [_jsx("svg", { className: "w-4 h-4", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M12 4v16m8-8H4" }) }), _jsx("span", { children: "Compose" })] })), _jsx(Button, { onClick: onSettings, variant: "ghost", className: "p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors", children: _jsxs("svg", { className: "w-5 h-5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: [_jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" }), _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M15 12a3 3 0 11-6 0 3 3 0 016 0z" })] }) }), _jsxs("div", { className: "relative", ref: userMenuRef, children: [_jsxs("button", { onClick: () => setShowUserMenu(!showUserMenu), className: "flex items-center gap-2.5 text-sm hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg px-3 py-1.5 transition-colors", children: [user && user.picture ? (_jsx("img", { src: user.picture, alt: user?.name || 'User', className: "w-8 h-8 rounded-full object-cover" })) : (_jsx("div", { className: "w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center", children: _jsx("span", { className: "text-white text-sm font-medium", children: user?.name?.charAt(0) || user?.email?.charAt(0) || 'U' }) })), _jsxs("div", { className: "hidden lg:block text-left", children: [_jsx("p", { className: "font-medium text-gray-900 dark:text-white text-sm truncate max-w-24", children: user?.name?.split(' ')[0] || 'User' }), _jsx("p", { className: "text-xs text-gray-500 dark:text-gray-400 truncate max-w-24", children: user?.email || 'user@example.com' })] }), _jsx("svg", { className: `w-4 h-4 text-gray-400 transition-transform ${showUserMenu ? 'rotate-180' : ''}`, fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M19 9l-7 7-7-7" }) })] }), showUserMenu && (_jsxs("div", { className: "absolute right-0 mt-1.5 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50", children: [_jsx("div", { className: "p-3 border-b border-gray-200 dark:border-gray-700", children: _jsxs("div", { className: "flex items-center gap-2", children: [user && user.picture ? (_jsx("img", { src: user.picture, alt: user?.name || 'User', className: "w-8 h-8 rounded-full object-cover" })) : (_jsx("div", { className: "w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center", children: _jsx("span", { className: "text-white text-sm font-medium", children: user?.name?.charAt(0) || user?.email?.charAt(0) || 'U' }) })), _jsxs("div", { className: "flex-1 min-w-0", children: [_jsx("p", { className: "text-sm font-medium text-gray-900 dark:text-white truncate", children: user?.name || 'User' }), _jsx("p", { className: "text-xs text-gray-500 dark:text-gray-400 truncate", children: user?.email || 'user@example.com' })] })] }) }), _jsx("div", { className: "p-1.5", children: _jsxs("button", { onClick: handleLogout, className: "w-full flex items-center gap-2 px-3 py-1.5 text-left text-xs text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors", children: [_jsx("svg", { className: "w-4 h-4", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" }) }), _jsx("span", { children: "Sign Out" })] }) })] }))] })] })] }) }));
};
